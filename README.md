# Monte Carlo Simulator Web åº”ç”¨

ä¸€ä¸ªåŸºäº Web çš„è’™ç‰¹å¡ç½—æ¨¡æ‹Ÿå·¥å…·ï¼Œç”¨äºé£é™©åˆ†æå’Œä¸ç¡®å®šæ€§é‡åŒ–ã€‚æ”¯æŒå¤šå˜é‡è¾“å…¥ã€è‡ªå®šä¹‰å…¬å¼è®¡ç®—ã€æ•æ„Ÿæ€§åˆ†æå’Œå¯è§†åŒ–æŠ¥å‘Šç”Ÿæˆã€‚

## é¡¹ç›®ç‰¹æ€§

- ğŸ“Š **çµæ´»çš„å˜é‡è¾“å…¥**
  - æ”¯æŒåŸå§‹æ•°æ®è¾“å…¥ï¼ˆè‡ªåŠ¨æ‹Ÿåˆåˆ†å¸ƒï¼‰
  - æ”¯æŒç»Ÿè®¡å‚æ•°è¾“å…¥ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰
  - æ”¯æŒ 9 ç§æ¦‚ç‡åˆ†å¸ƒç±»å‹
  - å¯è®¾ç½®é‡‡æ ·èŒƒå›´é™åˆ¶

- ğŸ§® **å¼ºå¤§çš„è®¡ç®—åŠŸèƒ½**
  - è‡ªå®šä¹‰æ•°å­¦å…¬å¼ï¼ˆæ”¯æŒåŸºæœ¬è¿ç®—å’Œæ•°å­¦å‡½æ•°ï¼‰
  - è‡ªå®šä¹‰ Python å‡½æ•°ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰
  - å¤§è§„æ¨¡è’™ç‰¹å¡ç½—æŠ½æ ·ï¼ˆé»˜è®¤ 100 ä¸‡æ¬¡ï¼‰
  - CDF æ‹Ÿåˆå’Œæ’å€¼

- ğŸ“ˆ **ä¸°å¯Œçš„å¯è§†åŒ–åˆ†æ**
  - ç»“æœåˆ†å¸ƒç›´æ–¹å›¾ï¼ˆå¸¦ PDF å’Œ CDFï¼‰
  - å˜é‡åˆ†å¸ƒå¯¹æ¯”å›¾
  - Pareto å›¾ï¼ˆå˜é‡é‡è¦æ€§åˆ†æï¼‰
  - Tornado å›¾ï¼ˆæ•æ„Ÿæ€§åˆ†æï¼‰

- ğŸ“„ **æŠ¥å‘Šç”Ÿæˆ**
  - ç»Ÿè®¡æ‘˜è¦ï¼ˆå‡å€¼ã€ä¸­ä½æ•°ã€æ ‡å‡†å·®ç­‰ï¼‰
  - ç½®ä¿¡åŒºé—´åˆ†æ
  - å›¾è¡¨å¯¼å‡º

- ğŸ‘¥ **å¤šç”¨æˆ·æ”¯æŒ**
  - Session éš”ç¦»ï¼ˆæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„æ¨¡æ‹Ÿç¯å¢ƒï¼‰
  - è‡ªåŠ¨æ¸…ç†ä¸æ´»è·ƒç”¨æˆ·æ•°æ®ï¼ˆ1 å°æ—¶ï¼‰

## æŠ€æœ¯æ ˆ

### åç«¯
- **Flask** 3.0.0 - Web æ¡†æ¶
- **NumPy** 1.24.3 - æ•°å€¼è®¡ç®—
- **SciPy** 1.11.2 - ç§‘å­¦è®¡ç®—å’Œç»Ÿè®¡
- **Matplotlib** 3.7.2 - æ•°æ®å¯è§†åŒ–
- **Seaborn** 0.12.2 - ç»Ÿè®¡å›¾è¡¨

### å‰ç«¯
- çº¯ HTML/CSS/JavaScriptï¼ˆæ— æ¡†æ¶ä¾èµ–ï¼‰
- ç°ä»£åŒ– UI è®¾è®¡
- å“åº”å¼å¸ƒå±€

## é¡¹ç›®ç»“æ„

```
monte-carlo-web/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.py              # Flask API æœåŠ¡
â”‚   â”œâ”€â”€ monte_carlo.py      # è’™ç‰¹å¡ç½—æ ¸å¿ƒç®—æ³•
â”‚   â””â”€â”€ requirements.txt    # Python ä¾èµ–
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ index.html          # Web ç•Œé¢
â”œâ”€â”€ Dockerfile              # Docker é•œåƒé…ç½®
â”œâ”€â”€ docker-compose.yml      # Docker Compose é…ç½®
â”œâ”€â”€ .gitignore             # Git å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md              # é¡¹ç›®æ–‡æ¡£
```

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1: Docker Composeï¼ˆæ¨èï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd monte-carlo-web

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# è®¿é—®åº”ç”¨
open http://localhost:5050
```

### æ–¹å¼ 2: æœ¬åœ°è¿è¡Œ

#### å‰ç½®è¦æ±‚
- Python 3.10+
- pip

#### å®‰è£…æ­¥éª¤

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd monte-carlo-web

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# æˆ–
venv\Scripts\activate     # Windows

# 3. å®‰è£…ä¾èµ–
cd backend
pip install -r requirements.txt

# 4. å¯åŠ¨æœåŠ¡
python app.py

# 5. è®¿é—®åº”ç”¨
# æµè§ˆå™¨æ‰“å¼€ http://localhost:5050
```

## ä½¿ç”¨æŒ‡å—

### 1. æ·»åŠ å˜é‡

#### æ–¹å¼ A: å•ä¸ªæ·»åŠ ï¼ˆå›¾å½¢ç•Œé¢ï¼‰
1. è¾“å…¥å˜é‡åï¼ˆå¦‚ `revenue`ï¼‰
2. é€‰æ‹©è¾“å…¥æ–¹å¼ï¼š
   - **åŸå§‹æ•°æ®**ï¼šç²˜è´´æµ‹è¯•æ•°æ®ï¼ˆé€—å·æˆ–ç©ºæ ¼åˆ†éš”ï¼‰
   - **ç»Ÿè®¡å‚æ•°**ï¼šè¾“å…¥å‡å€¼å’Œæ ‡å‡†å·®
3. é€‰æ‹©åˆ†å¸ƒç±»å‹ï¼ˆæ­£æ€åˆ†å¸ƒæˆ– t åˆ†å¸ƒï¼‰
4. ï¼ˆå¯é€‰ï¼‰è®¾ç½®æœ€å°å€¼å’Œæœ€å¤§å€¼é™åˆ¶
5. ç‚¹å‡»"æ·»åŠ å˜é‡"

#### æ–¹å¼ B: JSON æ‰¹é‡å¯¼å…¥
```json
[
  {
    "name": "revenue",
    "input_mode": "params",
    "mean": 1000000,
    "std": 50000,
    "dist_type": "normal"
  },
  {
    "name": "cost",
    "input_mode": "data",
    "data": [800000, 850000, 820000, 900000],
    "dist_type": "normal"
  }
]
```

### 2. è¿è¡Œæ¨¡æ‹Ÿ

#### ç®€å•å…¬å¼æ¨¡å¼
åœ¨å…¬å¼è¾“å…¥æ¡†è¾“å…¥è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š
```
revenue - cost
revenue * 0.15
sqrt(var_A^2 + var_B^2)
```

æ”¯æŒçš„æ•°å­¦å‡½æ•°ï¼š
- åŸºæœ¬è¿ç®—ï¼š`+`ã€`-`ã€`*`ã€`/`ã€`^`ï¼ˆå¹‚ï¼‰
- ä¸‰è§’å‡½æ•°ï¼š`sin()`ã€`cos()`ã€`tan()`
- æŒ‡æ•°å¯¹æ•°ï¼š`exp()`ã€`log()`ã€`log10()`ã€`ln()`ã€`sqrt()`

### æ”¯æŒçš„æ¦‚ç‡åˆ†å¸ƒ

ç³»ç»Ÿæ”¯æŒä»¥ä¸‹ 9 ç§æ¦‚ç‡åˆ†å¸ƒç±»å‹ï¼š

#### 1. **æ­£æ€åˆ†å¸ƒ (Normal/Gaussian)**
- **å‚æ•°**: `mean`ï¼ˆå‡å€¼ï¼‰, `std`ï¼ˆæ ‡å‡†å·®ï¼‰
- **é€‚ç”¨åœºæ™¯**: å¤§å¤šæ•°è‡ªç„¶ç°è±¡ã€æµ‹é‡è¯¯å·®ã€ä¸­å¿ƒæé™å®šç†é€‚ç”¨çš„æƒ…å†µ
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "revenue",
    "input_mode": "params",
    "dist_type": "norm",
    "mean": 1000000,
    "std": 50000
  }
  ```

#### 2. **t åˆ†å¸ƒ (Student's t-distribution)**
- **å‚æ•°**: `mean`ï¼ˆä½ç½®ï¼‰, `std`ï¼ˆå°ºåº¦ï¼‰, `df`ï¼ˆè‡ªç”±åº¦ï¼‰
- **é€‚ç”¨åœºæ™¯**: å°æ ·æœ¬æ•°æ®ã€é‡å°¾åˆ†å¸ƒã€æç«¯å€¼è¾ƒå¤šçš„æƒ…å†µ
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "cost",
    "input_mode": "params",
    "dist_type": "t",
    "mean": 800000,
    "std": 40000,
    "df": 5
  }
  ```

#### 3. **å¯¹æ•°æ­£æ€åˆ†å¸ƒ (Lognormal)**
- **å‚æ•°**: `mean`ï¼ˆå¯¹æ•°ç©ºé—´å‡å€¼ï¼‰, `std`ï¼ˆå¯¹æ•°ç©ºé—´æ ‡å‡†å·®ï¼‰
- **é€‚ç”¨åœºæ™¯**: ä»·æ ¼ã€æ”¶å…¥ã€èµ„äº§ä»·å€¼ç­‰åªèƒ½ä¸ºæ­£çš„å˜é‡
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "asset_value",
    "input_mode": "params",
    "dist_type": "lognormal",
    "mean": 13.8,
    "std": 0.5
  }
  ```

#### 4. **å‡åŒ€åˆ†å¸ƒ (Uniform)**
- **å‚æ•°**: `min`ï¼ˆæœ€å°å€¼ï¼‰, `max`ï¼ˆæœ€å¤§å€¼ï¼‰
- **é€‚ç”¨åœºæ™¯**: æ‰€æœ‰å€¼ç­‰å¯èƒ½ã€ç¼ºä¹å…ˆéªŒä¿¡æ¯çš„æƒ…å†µ
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "discount_rate",
    "input_mode": "params",
    "dist_type": "uniform",
    "min": 0.05,
    "max": 0.15
  }
  ```

#### 5. **ä¸‰è§’åˆ†å¸ƒ (Triangular)**
- **å‚æ•°**: `min`ï¼ˆæœ€å°å€¼ï¼‰, `mode`ï¼ˆä¼—æ•°ï¼‰, `max`ï¼ˆæœ€å¤§å€¼ï¼‰
- **é€‚ç”¨åœºæ™¯**: ä¸“å®¶ä¼°è®¡ã€é¡¹ç›®ç®¡ç†ï¼ˆPERTï¼‰ã€æœ‰æ˜ç¡®ä¸Šä¸‹é™å’Œæœ€å¯èƒ½å€¼
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "project_duration",
    "input_mode": "params",
    "dist_type": "triangular",
    "min": 10,
    "mode": 15,
    "max": 25
  }
  ```

#### 6. **Beta åˆ†å¸ƒ (Beta)**
- **å‚æ•°**: `alpha`ï¼ˆå½¢çŠ¶å‚æ•°1ï¼‰, `beta`ï¼ˆå½¢çŠ¶å‚æ•°2ï¼‰, `min`ï¼ˆä¸‹ç•Œï¼Œé»˜è®¤0ï¼‰, `max`ï¼ˆä¸Šç•Œï¼Œé»˜è®¤1ï¼‰
- **é€‚ç”¨åœºæ™¯**: æœ‰ç•Œå˜é‡ã€ç™¾åˆ†æ¯”ã€æ¦‚ç‡ã€å®Œæˆåº¦
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "completion_rate",
    "input_mode": "params",
    "dist_type": "beta",
    "alpha": 2,
    "beta": 5,
    "min": 0,
    "max": 1
  }
  ```

#### 7. **Gamma åˆ†å¸ƒ (Gamma)**
- **å‚æ•°**: `shape`ï¼ˆå½¢çŠ¶å‚æ•°ï¼‰, `scale`ï¼ˆå°ºåº¦å‚æ•°ï¼‰
- **é€‚ç”¨åœºæ™¯**: ç­‰å¾…æ—¶é—´ã€å¯¿å‘½åˆ†æã€æ­£åæ€æ•°æ®
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "waiting_time",
    "input_mode": "params",
    "dist_type": "gamma",
    "shape": 2,
    "scale": 3
  }
  ```

#### 8. **æŒ‡æ•°åˆ†å¸ƒ (Exponential)**
- **å‚æ•°**: `scale`ï¼ˆå°ºåº¦å‚æ•°ï¼‰æˆ– `rate`ï¼ˆé€Ÿç‡å‚æ•°ï¼Œrate = 1/scaleï¼‰
- **é€‚ç”¨åœºæ™¯**: æ— è®°å¿†è¿‡ç¨‹ã€æ•…éšœæ—¶é—´ã€æœåŠ¡æ—¶é—´
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "failure_time",
    "input_mode": "params",
    "dist_type": "exponential",
    "scale": 100
  }
  ```

#### 9. **Weibull åˆ†å¸ƒ (Weibull)**
- **å‚æ•°**: `shape`ï¼ˆå½¢çŠ¶å‚æ•°ï¼‰, `scale`ï¼ˆå°ºåº¦å‚æ•°ï¼‰
- **é€‚ç”¨åœºæ™¯**: å¯é æ€§åˆ†æã€å¯¿å‘½æµ‹è¯•ã€é£é€Ÿåˆ†å¸ƒ
- **ç¤ºä¾‹**:
  ```json
  {
    "name": "component_lifetime",
    "input_mode": "params",
    "dist_type": "weibull",
    "shape": 1.5,
    "scale": 5000
  }
  ```

### åˆ†å¸ƒé€‰æ‹©æŒ‡å—

| åˆ†å¸ƒç±»å‹ | æ”¯æŒèŒƒå›´ | å…¸å‹åº”ç”¨ | ç‰¹ç‚¹ |
|---------|---------|---------|------|
| Normal | (-âˆ, +âˆ) | æµ‹é‡è¯¯å·®ã€è‡ªç„¶ç°è±¡ | å¯¹ç§°ã€é’Ÿå½¢ |
| t | (-âˆ, +âˆ) | å°æ ·æœ¬ã€é‡å°¾æ•°æ® | æ¯”æ­£æ€åˆ†å¸ƒæ›´é‡çš„å°¾éƒ¨ |
| Lognormal | (0, +âˆ) | ä»·æ ¼ã€æ”¶å…¥ | å³åã€åªèƒ½ä¸ºæ­£ |
| Uniform | [min, max] | ç¼ºä¹ä¿¡æ¯æ—¶ | æ‰€æœ‰å€¼ç­‰å¯èƒ½ |
| Triangular | [min, max] | ä¸“å®¶ä¼°è®¡ | ç®€å•ã€ç›´è§‚ |
| Beta | [min, max] | ç™¾åˆ†æ¯”ã€æ¦‚ç‡ | çµæ´»çš„æœ‰ç•Œåˆ†å¸ƒ |
| Gamma | (0, +âˆ) | ç­‰å¾…æ—¶é—´ | å³åã€åªèƒ½ä¸ºæ­£ |
| Exponential | (0, +âˆ) | æ•…éšœæ—¶é—´ | æ— è®°å¿†æ€§ |
| Weibull | (0, +âˆ) | å¯é æ€§åˆ†æ | çµæ´»çš„å¯¿å‘½åˆ†å¸ƒ |

#### è‡ªå®šä¹‰å‡½æ•°æ¨¡å¼
```python
def custom_formula(vars):
    revenue = vars['revenue']
    cost = vars['cost']
    
    # å¤æ‚è®¡ç®—é€»è¾‘
    if revenue > 1000000:
        profit = (revenue - cost) * 0.85
    else:
        profit = (revenue - cost) * 0.90
    
    return profit
```

### 3. åˆ†æç»“æœ

è¿è¡Œæ¨¡æ‹Ÿåï¼Œç³»ç»Ÿä¼šç”Ÿæˆï¼š
- **ç»Ÿè®¡æ‘˜è¦**ï¼šå‡å€¼ã€ä¸­ä½æ•°ã€æ ‡å‡†å·®ã€ååº¦ã€å³°åº¦
- **ç½®ä¿¡åŒºé—´**ï¼š95%ã€99% ç­‰ç½®ä¿¡æ°´å¹³çš„åŒºé—´ä¼°è®¡
- **å¯è§†åŒ–å›¾è¡¨**ï¼š
  - ç»“æœåˆ†å¸ƒå›¾ï¼ˆç›´æ–¹å›¾ + PDF + CDFï¼‰
  - å˜é‡åˆ†å¸ƒå¯¹æ¯”
  - Pareto å›¾ï¼ˆè¯†åˆ«å…³é”®å˜é‡ï¼‰
  - Tornado å›¾ï¼ˆæ•æ„Ÿæ€§æ’åï¼‰

### 4. ç”ŸæˆæŠ¥å‘Š

ç‚¹å‡»"ç”ŸæˆæŠ¥å‘Š"æŒ‰é’®ï¼Œè·å–åŒ…å«æ‰€æœ‰åˆ†æç»“æœçš„æ–‡æœ¬æŠ¥å‘Šã€‚

## API æ–‡æ¡£

### å˜é‡ç®¡ç†

#### æ·»åŠ å•ä¸ªå˜é‡
```http
POST /api/add_variable
Content-Type: application/json

{
  "name": "var_name",
  "input_mode": "params",
  "mean": 100,
  "std": 10,
  "dist_type": "normal",
  "min_value": null,
  "max_value": null
}
```

#### æ‰¹é‡æ·»åŠ å˜é‡
```http
POST /api/add_variables_json
Content-Type: application/json

{
  "variables": [...]
}
```

#### åˆ—å‡ºæ‰€æœ‰å˜é‡
```http
GET /api/list_variables
```

### æ¨¡æ‹Ÿè¿è¡Œ

#### è¿è¡Œæ¨¡æ‹Ÿ
```http
POST /api/run_simulation
Content-Type: application/json

{
  "formula": "var_A + var_B",
  "result_name": "Result",
  "n_samples": 1000000,
  "cdf_fit_degree": 5,
  "use_custom_function": false,
  "custom_function_code": ""
}
```

#### åˆ†æç»“æœ
```http
POST /api/analyze_result
Content-Type: application/json

{
  "confidence_levels": [0.95, 0.99]
}
```

#### ç”Ÿæˆå›¾è¡¨
```http
POST /api/generate_charts
Content-Type: application/json

{
  "chart_types": ["result_plot", "var_distributions", "pareto", "tornado"]
}
```

#### ç”ŸæˆæŠ¥å‘Š
```http
POST /api/generate_report
Content-Type: application/json

{
  "confidence_levels": [0.95, 0.99]
}
```

### ç³»ç»Ÿç®¡ç†

#### é‡ç½®æ¨¡æ‹Ÿå™¨
```http
POST /api/reset
```

### æµ‹è¯•

```bash
# è¿è¡Œåç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
cd backend
python app.py

# æµ‹è¯• API
curl http://localhost:5050/api/list_variables
```

## éƒ¨ç½²

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t monte-carlo-web .

# è¿è¡Œå®¹å™¨
docker run -d -p 5050:5050 --name monte-carlo monte-carlo-web
```

## å¸¸è§é—®é¢˜

### Q: å›¾è¡¨æ˜¾ç¤ºä¸­æ–‡ä¹±ç æ€ä¹ˆåŠï¼Ÿ
A: ç¡®ä¿ç³»ç»Ÿå®‰è£…äº†ä¸­æ–‡å­—ä½“ï¼ˆSimHei æˆ– Arial Unicode MSï¼‰ã€‚åœ¨ Docker ç¯å¢ƒä¸­ï¼Œå¯èƒ½éœ€è¦åœ¨ Dockerfile ä¸­æ·»åŠ å­—ä½“å®‰è£…æ­¥éª¤ã€‚

### Q: æ¨¡æ‹Ÿé€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ
A: 
1. å‡å°‘é‡‡æ ·æ¬¡æ•°ï¼ˆ`n_samples`ï¼‰
2. ä½¿ç”¨ Docker éƒ¨ç½²ï¼ˆæ›´ç¨³å®šçš„æ€§èƒ½ï¼‰
3. è€ƒè™‘ä½¿ç”¨æ›´å¼ºå¤§çš„æœåŠ¡å™¨

### Q: å¦‚ä½•å¤‡ä»½æ¨¡æ‹Ÿæ•°æ®ï¼Ÿ
A: å½“å‰ç‰ˆæœ¬æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚å¦‚éœ€æŒä¹…åŒ–ï¼Œå¯ä»¥ï¼š
1. å¯¼å‡º JSON é…ç½®
2. ä¿å­˜ç”Ÿæˆçš„æŠ¥å‘Š
3. è€ƒè™‘æ·»åŠ æ•°æ®åº“æ”¯æŒï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰

## è®¸å¯è¯

[MIT License](LICENSE)

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³» [jeff0319@gmail.com]

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-10-26)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒåŸºæœ¬çš„è’™ç‰¹å¡ç½—æ¨¡æ‹ŸåŠŸèƒ½
- Web ç•Œé¢å’Œ API
- Docker æ”¯æŒ
